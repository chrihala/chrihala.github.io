---
layout: post
title: 'Landesk Management Suite: Managing the Manager'
date: '2016-11-17T23:24:00.000-08:00'
author: Hland
tags:
- memorydump
- credentials
- session handling
- landesk
modified_time: '2016-11-17T23:24:13.123-08:00'
thumbnail: https://1.bp.blogspot.com/-SE6MHfAdvOg/WC4UWhr1doI/AAAAAAAAOK8/oWlMAWfzFUMimDyOakvuGiYZl6J0HhmrwCLcB/s72-c/Landesk_bruteforcing_session_id.png
blogger_id: tag:blogger.com,1999:blog-3264165303439231899.post-8002069306617864187
blogger_orig_url: https://blankhat.blogspot.com/2016/11/landesk-management-suite-managing.html
---

I recently got the chance to look a little deeper at Landesk Management Suite 2016. This is a system for the enterprise IT department that wish to provide remote support to their employees.<br /><br />Now enterprises are very different, some are super-large clunky and some are smaller and more agile. Some (a few?) have really mature security programs with locked down clients and others are more liberal allowing users more power and responsibility.<br /><br />The following findings aren't super-critical in the sense that they undermine Landesks security model completely in every case. Rather, in specific cases it may be sufficient with enough mitigating controls in place. But in some cases these flaws will lead to complete compromise and keys to the kingdom.<br /><br />I write this from the perspective of a typical red-team engagement where the first step is to gain a foothold on an employee computer. This is typically relatively easily achieved using spearphishing with some client attack be it macro-enabled documents or a browser exploit. When the foothold has been established the hunt for local privilege escalation and lateral movement opportunities begins.<br />I discovered two flaws in the Landesk agent that facilitate potentially both of these desires. Let's dive in.<br /><br /><h3>#1 HTML Remote Control: Weak Session Identifier</h3><div>If an employee in upper management has trouble with opening his email, the idea is that a battle-hardened IT-support person should be able to remotely manage the computer via Landesk HTML Remote Control. This is basically the same functionality as Teamviewer just through your browser. How it works is that the agent exposes a web server on port 4343 and the support person authenticates to this service using his LDAP credentials and gets access to see the screen of the person he is helping.&nbsp;</div><div><br /></div><div>The connection to the agent is encrypted and the certificate is valid and trusted by the support person's machine as the Landesk Management Suite Console software adds this to the OS's list of trusted CAs.</div><div><br /></div><div>Now what happens is that the credentials are POSTed to the webservers /cgi-bin/start and the website uses javascript to poll the same endpoint until the response is either success or fiasko. Success is signified by the server returning a session ID. Looking at the traffic I could see that this session ID was only <b>5 digits. </b>Sometimes I logged in it was only 4 digits! Spinning red lamps went off in my head as the potential for a bruteforce attack here was pretty nice. Let's see 4 digits = 10 000 combos. 5 digits = 100 000 combos to bruteforce. This isn't really unfeasible unless there is some sort of rate-limiting on the Landesk agent's web server.&nbsp;</div><div><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-SE6MHfAdvOg/WC4UWhr1doI/AAAAAAAAOK8/oWlMAWfzFUMimDyOakvuGiYZl6J0HhmrwCLcB/s1600/Landesk_bruteforcing_session_id.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="283" src="https://1.bp.blogspot.com/-SE6MHfAdvOg/WC4UWhr1doI/AAAAAAAAOK8/oWlMAWfzFUMimDyOakvuGiYZl6J0HhmrwCLcB/s640/Landesk_bruteforcing_session_id.png" width="640" /></a></div><div><br /></div><br /><br /><br /><br /><br /><br /><br />